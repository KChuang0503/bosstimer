<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boss é‡ç”Ÿè¨ˆæ™‚å™¨</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chiron+GoRound+TC:wght@200..900&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
</head>

<body>
    <div class="container">
        <h1>Boss é‡ç”Ÿè¨ˆæ™‚å™¨</h1>

        <div class="main-layout">
            <!-- å·¦å´ï¼šBoss è¨ˆæ™‚å™¨æ§åˆ¶é¢æ¿ -->
            <div class="timer-panel">
                <div class="boss-selector">
                    <div class="chapter-selector">
                        <label for="chapter">é¸æ“‡ç« ç¯€ï¼š</label>
                        <select id="chapter">
                            <option value="7">ç¬¬ä¸ƒç« </option>
                            <option value="8">ç¬¬å…«ç« </option>
                            <option value="9">ç¬¬ä¹ç« </option>
                            <option value="10">ç¬¬åç« </option>
                        </select>
                    </div>

                    <div class="boss-selector">
                        <label for="boss">é¸æ“‡åœ°åœ–ï¼š</label>
                        <select id="boss">
                            <option value="7-1">æ‰å¡é‡Œè€¶çˆ¾äº¤å‰è·¯</option>
                            <option value="7-2">ç‹é™µä¸€å±¤</option>
                            <option value="7-3">ç‹é™µäºŒå±¤</option>
                            <option value="7-4">ç‹é™µä¸‰å±¤</option>
                        </select>
                    </div>

                    <div class="server-selector">
                        <label for="server">é¸æ“‡åˆ†æµï¼š</label>
                        <select id="server">
                            <option value="1">åˆ†æµ 1</option>
                            <option value="2">åˆ†æµ 2</option>
                            <option value="3">åˆ†æµ 3</option>
                            <option value="4">åˆ†æµ 4</option>
                            <option value="5">åˆ†æµ 5</option>
                            <option value="6">åˆ†æµ 6</option>
                            <option value="7">åˆ†æµ 7</option>
                            <option value="8">åˆ†æµ 8</option>
                            <option value="9">åˆ†æµ 9</option>
                        </select>
                    </div>
                </div>

                <div class="timer-setup">
                    <div class="input-group">
                        <label for="hours">å°æ™‚</label>
                        <input type="number" id="hours" min="0" max="23" value="0" placeholder="0">
                    </div>

                    <div class="input-group">
                        <label for="minutes">åˆ†é˜</label>
                        <input type="number" id="minutes" min="0" max="59" value="0" placeholder="0">
                    </div>

                    <div class="input-group">
                        <label for="seconds">ç§’æ•¸</label>
                        <input type="number" id="seconds" min="0" max="59" value="0" placeholder="0">
                    </div>
                </div>

                <div class="controls">
                    <button id="addTimerBtn" class="btn btn-add">æ–°å¢è¨ˆæ™‚å™¨</button>
                    <button id="resetBtn" class="btn btn-reset">é‡ç½®</button>
                </div>

                <div class="share-section">
                    <h4>åˆ†äº«è¨ˆæ™‚å™¨</h4>
                    <div class="share-controls">
                        <button id="shareBtn" class="btn btn-share">ğŸ”— ç”Ÿæˆåˆ†äº«é€£çµ</button>
                        <button id="importBtn" class="btn btn-import">ğŸ“¥ åŒ¯å…¥åˆ†äº«é€£çµ</button>
                    </div>
                    <div class="sync-status" id="syncStatus" style="display: none;">
                        <div class="sync-indicator">
                            <span class="sync-icon">ğŸ”„</span>
                            <span class="sync-text">åŒæ­¥ä¸­...</span>
                        </div>
                        <div class="sync-info">
                            <span id="syncRole">ä¸»æ©Ÿ</span> | æˆ¿é–“: <span id="roomId">-</span>
                        </div>
                    </div>
                </div>

                <div class="notification-controls">
                    <div class="volume-control">
                        <input type="range" id="volumeSlider" min="0" max="100" value="50" class="volume-slider">
                        <span id="volumeValue">50%</span>
                    </div>
                    <div class="mute-control">
                        <button id="muteBtn" class="btn btn-mute">ğŸ”Š</button>
                    </div>
                </div>

                <div class="status" id="status">é¸æ“‡åœ°åœ–ä¸¦è¨­å®šé‡ç”Ÿæ™‚é–“</div>
            </div>

            <!-- å³å´ï¼šé€²è¡Œä¸­çš„è¨ˆæ™‚å™¨åˆ—è¡¨ -->
            <div class="active-timers">
                <h3>é€²è¡Œä¸­çš„è¨ˆæ™‚å™¨</h3>
                <div class="timers-list" id="timersList"></div>
            </div>
        </div>
    </div>

    <!-- Lightbox å½ˆå‡ºè¦–çª— -->
    <div id="lightbox" class="lightbox">
        <div class="lightbox-content">
            <div class="lightbox-header">
                <h3 id="lightboxTitle">åˆ†äº«è¨ˆæ™‚å™¨</h3>
                <button id="closeLightbox" class="btn-close">&times;</button>
            </div>
            <div class="lightbox-body">
                <!-- åˆ†äº«é€£çµå…§å®¹ -->
                <div id="shareContent" class="lightbox-section" style="display: none;">
                    <label for="shareUrl">åˆ†äº«é€£çµï¼š</label>
                    <div class="url-input-group">
                        <input type="text" id="shareUrl" readonly>
                        <button id="copyBtn" class="btn btn-copy">è¤‡è£½</button>
                    </div>
                    <div class="share-info">
                        <p>å°‡æ­¤é€£çµåˆ†äº«çµ¦æœ‹å‹ï¼Œä»–å€‘å¯ä»¥è¼‰å…¥æ‚¨çš„è¨ˆæ™‚å™¨è¨­å®š</p>
                    </div>
                </div>
                
                <!-- åŒ¯å…¥é€£çµå…§å®¹ -->
                <div id="importContent" class="lightbox-section" style="display: none;">
                    <label for="importUrl">è²¼ä¸Šåˆ†äº«é€£çµï¼š</label>
                    <div class="url-input-group">
                        <input type="text" id="importUrl" placeholder="è²¼ä¸Šåˆ†äº«é€£çµ...">
                        <button id="pasteBtn" class="btn btn-paste">ğŸ“‹ è²¼ä¸Š</button>
                        <button id="loadBtn" class="btn btn-load">è¼‰å…¥</button>
                    </div>
                    <div class="import-info">
                        <p>è²¼ä¸Šæœ‹å‹åˆ†äº«çš„é€£çµä¾†è¼‰å…¥ä»–å€‘çš„è¨ˆæ™‚å™¨è¨­å®šï¼Œæˆ–ç›´æ¥é»æ“Šè¼‰å…¥å¾å‰ªè²¼æ¿è®€å–</p>
                    </div>
                </div>
            </div>
            <div class="lightbox-footer">
                <button id="cancelBtn" class="btn btn-cancel">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- Firebase é…ç½® -->
    <script>
        // å˜—è©¦è¼‰å…¥ Firebase é…ç½®
        let firebaseConfigLoaded = false;
        
        // å‰µå»º script æ¨™ç±¤ä¾†è¼‰å…¥é…ç½®
        const configScript = document.createElement('script');
        configScript.src = 'firebase-config.js';
        configScript.onload = function() {
            console.log('Firebase é…ç½®æ–‡ä»¶è¼‰å…¥æˆåŠŸ');
            firebaseConfigLoaded = true;
            initializeFirebase();
        };
        configScript.onerror = function() {
            console.error('Firebase é…ç½®æ–‡ä»¶è¼‰å…¥å¤±æ•—');
            showConfigError();
        };
        document.head.appendChild(configScript);
        
        // è¨­ç½®è¶…æ™‚æª¢æŸ¥
        setTimeout(function() {
            if (!firebaseConfigLoaded) {
                console.error('Firebase é…ç½®æ–‡ä»¶è¼‰å…¥è¶…æ™‚');
                showConfigError();
            }
        }, 3000);
        
        function showConfigError() {
            document.body.innerHTML = `
                <div style="text-align: center; padding: 50px; color: red; font-family: Arial, sans-serif;">
                    <h1>ğŸ”§ é…ç½®éŒ¯èª¤</h1>
                    <p>Firebase é…ç½®æ–‡ä»¶æœªæ‰¾åˆ°æˆ–è¼‰å…¥å¤±æ•—</p>
                    <div style="background: #f5f5f5; padding: 20px; margin: 20px; border-radius: 8px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto;">
                        <h3>è§£æ±ºæ­¥é©Ÿï¼š</h3>
                        <ol>
                            <li>ç¢ºä¿ <code>firebase-config.js</code> æ–‡ä»¶å­˜åœ¨æ–¼é …ç›®æ ¹ç›®éŒ„</li>
                            <li>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè«‹è¤‡è£½ <code>firebase-config.example.js</code> ç‚º <code>firebase-config.js</code></li>
                            <li>ç·¨è¼¯ <code>firebase-config.js</code> ä¸¦å¡«å…¥æ‚¨çš„ Firebase é…ç½®</li>
                            <li>é‡æ–°è¼‰å…¥é é¢</li>
                        </ol>
                        <p><strong>æ³¨æ„ï¼š</strong>è«‹ç¢ºä¿ä½¿ç”¨æœ¬åœ°æœå‹™å™¨é‹è¡Œæ­¤æ‡‰ç”¨ç¨‹å¼ï¼Œè€Œä¸æ˜¯ç›´æ¥é–‹å•Ÿ HTML æ–‡ä»¶</p>
                    </div>
                </div>
            `;
        }
        
        function initializeFirebase() {
            if (typeof window.firebaseConfig !== 'undefined') {
                try {
                    // åˆå§‹åŒ– Firebase
                    firebase.initializeApp(window.firebaseConfig);
                    
                    // ç²å– Firebase æœå‹™
                    const database = firebase.database();
                    const auth = firebase.auth();
                    
                    console.log('Firebase åˆå§‹åŒ–æˆåŠŸ');
                } catch (error) {
                    console.error('Firebase åˆå§‹åŒ–å¤±æ•—:', error);
                    showConfigError();
                }
            } else {
                console.error('window.firebaseConfig æœªå®šç¾©');
                showConfigError();
            }
        }
    </script>
    
    <script src="script.js"></script>
    
</body>

</html>